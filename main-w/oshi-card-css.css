/* ===== Design Tokens & Container Base ===== */

& {
  --ink: #f2f2f2;
  --ink-muted: #b8b8b8;
  --accent: #ffffff;
  --accent-2: #d6d6d6;
  --bg: #050505;
  --static-image: url("https://i.imgur.com/PiQqhGH.gif");
  --static-size: 240px 240px;
  --avatar-size: 80px;
  --avatar-border: 2px;
  --hex: polygon(25% 6.7%, 75% 6.7%, 100% 50%, 75% 93.3%, 25% 93.3%, 0% 50%);
  --card: rgba(8, 8, 8, 0.72);
  --card-border: rgba(255, 255, 255, 0.18);
  --glow: rgba(255, 255, 255, 0.25);
  --border-w: 1px;
  --chamfer-lg: 18px;
  --chamfer-md: 12px;
  --chamfer-sm: 8px;
  --chamfer: var(--chamfer-md);
  --chamfer-shape: polygon(
    var(--chamfer) 0,
    calc(100% - var(--chamfer)) 0,
    100% var(--chamfer),
    100% calc(100% - var(--chamfer)),
    calc(100% - var(--chamfer)) 100%,
    var(--chamfer) 100%,
    0 calc(100% - var(--chamfer)),
    0 var(--chamfer)
  );

  color: var(--ink);
  font-family: "Courier New", "Consolas", "Lucida Console", monospace;
  letter-spacing: 0.4px;
  background-color: var(--bg) !important;
  position: relative;
  isolation: isolate;
  overflow: hidden;
  text-shadow: 0 0 4px rgba(255, 255, 255, 0.15);
}


/* ===== Background: static noise + fog ===== */

&::before {
  content: "";
  position: absolute;
  inset: 0;
  background:
    var(--static-image),
    radial-gradient(60% 45% at 20% 15%, rgba(255, 255, 255, 0.08), transparent 60%),
    radial-gradient(50% 40% at 80% 20%, rgba(255, 255, 255, 0.06), transparent 65%),
    radial-gradient(50% 50% at 50% 85%, rgba(255, 255, 255, 0.05), transparent 70%),
    linear-gradient(180deg, rgba(0, 0, 0, 0.35), rgba(0, 0, 0, 0.65));
  background-repeat: repeat, no-repeat, no-repeat, no-repeat, no-repeat;
  background-size: var(--static-size), auto, auto, auto, auto;
  background-position: center;
  filter: contrast(1.05);
  transform: rotate(180deg);
  pointer-events: none;
  z-index: 0;
}


/* ===== Scanlines + analog drift ===== */

&::after {
  content: "";
  position: absolute;
  inset: 0;
  background:
    repeating-linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0.035),
      rgba(255, 255, 255, 0.035) 1px,
      transparent 1px,
      transparent 3px
    );
  mix-blend-mode: screen;
  pointer-events: none;
  z-index: 0;
  animation: vt-drift 8s linear infinite;
}


/* ===== All direct children above overlays ===== */

& > * {
  position: relative;
  z-index: 1;
}


/* ===== Identity: Avatar, Name, Username ===== */

.oshi-card-identity {
  position: relative;
  z-index: 2;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 16px 12px 8px;
}

/* Strip platform's default avatar chrome */
.oshi-card-avatar {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  background: none !important;
  background-image: none !important;
  border: none !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  padding: 0 !important;
  -webkit-clip-path: var(--hex);
  clip-path: var(--hex);
}
.oshi-card-avatar::before {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: calc(var(--avatar-size) + (var(--avatar-border) * 2) + 4px);
  height: calc(var(--avatar-size) + (var(--avatar-border) * 2) + 4px);
  transform: translate(-50%, -50%);
  background: rgba(255, 255, 255, 0.35);
  -webkit-clip-path: var(--hex);
  clip-path: var(--hex);
  box-shadow:
    0 0 12px rgba(255, 255, 255, 0.18),
    0 0 28px rgba(255, 255, 255, 0.08),
    0 10px 16px rgba(0, 0, 0, 0.45);
  filter: blur(0.2px);
  pointer-events: none;
  z-index: 0;
}
.oshi-card-avatar img {
  width: var(--avatar-size) !important;
  height: var(--avatar-size) !important;
  border: none !important;
  border-radius: 0 !important;
  -webkit-clip-path: var(--hex);
  clip-path: var(--hex);
  aspect-ratio: 1 / 1;
  position: relative;
  z-index: 1;
}

/* Display name ‚Äî flickering terminal text */
.oshi-card-name {
  font-size: 1.2rem !important;
  letter-spacing: 1.6px;
  text-transform: uppercase;
  color: #ffffff;
  margin: 8px 0 2px;
  font-family: "Courier New", "Consolas", "Lucida Console", monospace;
  animation: vt-name-flicker 2.8s steps(1) infinite, vt-name-mask 1.6s steps(8) infinite;
  -webkit-mask-image: repeating-linear-gradient(
    90deg,
    rgba(0, 0, 0, 1) 0 60%,
    rgba(0, 0, 0, 0.35) 60% 80%,
    rgba(0, 0, 0, 1) 80% 100%
  );
  mask-image: repeating-linear-gradient(
    90deg,
    rgba(0, 0, 0, 1) 0 60%,
    rgba(0, 0, 0, 0.35) 60% 80%,
    rgba(0, 0, 0, 1) 80% 100%
  );
  -webkit-mask-size: 1ch 100%;
  mask-size: 1ch 100%;
}

/* Username */
.oshi-card-username {
  color: var(--ink-muted);
  text-decoration: underline;
  text-decoration-style: dotted;
  text-underline-offset: 3px;
  font-size: 0.85em;
  letter-spacing: 0.8px;
}
.oshi-card-username:hover {
  color: var(--accent-2);
  text-shadow: 0 0 8px rgba(255, 255, 255, 0.35);
}


/* ===== Card Sections (Top Friends, Bulletins, etc.) ===== */

.card.oshi-card-section {
  background: var(--card-border);
  border: none !important;
  border-radius: 0 !important;
  margin: 12px;
  padding: 10px;
  position: relative;
  overflow: visible;
  -webkit-clip-path: var(--chamfer-shape);
  clip-path: var(--chamfer-shape);
  --chamfer: var(--chamfer-md);
  filter: drop-shadow(0 8px 20px rgba(0, 0, 0, 0.6));
}
/* Inner fill ‚Äî creates the visible border gap */
.card.oshi-card-section::before {
  content: "";
  position: absolute;
  inset: var(--border-w);
  background: var(--card);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  -webkit-clip-path: var(--chamfer-shape);
  clip-path: var(--chamfer-shape);
  z-index: -1;
}
/* Static texture overlay */
.card.oshi-card-section::after {
  content: "";
  position: absolute;
  inset: var(--border-w);
  background-image: var(--static-image);
  background-repeat: repeat;
  background-size: 200px 200px;
  opacity: 0.14;
  filter: blur(1.2px) contrast(1.1);
  transform: rotate(180deg);
  -webkit-clip-path: var(--chamfer-shape);
  clip-path: var(--chamfer-shape);
  pointer-events: none;
  z-index: -1;
}
.card.oshi-card-section > * {
  position: relative;
  z-index: 1;
}

/* Card headers */
.card-header {
  background: none !important;
  background-image: none !important;
  border: none !important;
  text-align: center;
  font-weight: 700;
  font-size: 0.9em;
  color: var(--accent);
  letter-spacing: 1px;
  padding: 4px 0 6px;
  text-transform: uppercase;
  font-family: "Courier New", "Consolas", "Lucida Console", monospace;
}
.card-header::before,
.card-header::after {
  background: none !important;
  background-image: none !important;
}


/* ===== Top Friends ===== */
/*
 * Toggle off by uncommenting:
 *   .card.oshi-card-section:has(.oshi-card-top-friends) { display: none !important; }
 */

.oshi-card-top-friends {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 8px;
  padding: 4px 0;
}

.oshi-card-top-friend {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  text-decoration: none !important;
  position: relative;
  padding: 4px;
  transition: transform 0.2s ease, filter 0.2s ease;
}
.oshi-card-top-friend:hover {
  transform: translateY(-2px);
  filter: drop-shadow(0 6px 14px rgba(0, 0, 0, 0.5));
}

/* Hex border frame behind friend avatar */
.oshi-card-top-friend-avatar {
  position: relative;
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.oshi-card-top-friend-avatar::before {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: calc(48px + var(--avatar-border) * 2 + 6px);
  height: calc(48px + var(--avatar-border) * 2 + 6px);
  transform: translate(-50%, -50%);
  background: var(--card-border);
  -webkit-clip-path: var(--hex);
  clip-path: var(--hex);
  z-index: -2;
}
.oshi-card-top-friend-avatar::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: calc(48px + var(--avatar-border) * 2 + 6px - var(--border-w) * 2);
  height: calc(48px + var(--avatar-border) * 2 + 6px - var(--border-w) * 2);
  transform: translate(-50%, -50%);
  background: var(--card);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  -webkit-clip-path: var(--hex);
  clip-path: var(--hex);
  z-index: -1;
}
.oshi-card-top-friend-avatar img {
  width: 44px !important;
  height: 44px !important;
  border: none !important;
  border-radius: 0 !important;
  -webkit-clip-path: var(--hex);
  clip-path: var(--hex);
  position: relative;
  z-index: 1;
  filter: grayscale(1) drop-shadow(0 0 1.5px rgba(255, 255, 255, 0.35));
}

/* Friend name */
.oshi-card-top-friend-name {
  color: var(--ink-muted);
  font-size: 0.7em;
  letter-spacing: 0.5px;
  text-align: center;
}


/* ===== Bulletins / Content Items ===== */

.oshi-card-content-item {
  display: block;
  padding: 10px 12px;
  margin: 6px 0;
  text-decoration: none !important;
  color: var(--ink);
  border-bottom: 1px dotted rgba(255, 255, 255, 0.15);
  transition: background 0.2s ease;
}
.oshi-card-content-item:last-child {
  border-bottom: none;
}
.oshi-card-content-item:hover {
  background: rgba(255, 255, 255, 0.05);
}

.oshi-card-content-title {
  color: var(--accent) !important;
  font-weight: 700;
  font-size: 0.9em;
  letter-spacing: 0.5px;
  margin-bottom: 2px;
}

.oshi-card-content-meta {
  color: var(--ink-muted) !important;
  font-size: 0.75em;
  letter-spacing: 1px;
  opacity: 0.7;
}

.oshi-card-content-body {
  color: var(--ink) !important;
  font-size: 0.82em;
  line-height: 1.6;
  margin-top: 6px;
  opacity: 0.85;
}
.oshi-card-content-body * {
  color: var(--ink) !important;
}
.oshi-card-content-body a {
  color: var(--accent) !important;
  text-decoration: underline;
  text-decoration-style: dotted;
  text-underline-offset: 3px;
}


/* ===== Custom HTML / Blurb Area ===== */

.oshi-card-custom-html {
  position: relative;
  z-index: 2;
  padding: 8px 16px 16px;
  color: var(--ink);
  text-align: center;
  overflow: hidden;
  text-shadow:
    0 0 2px rgba(255, 255, 255, 0.35),
    0 0 6px rgba(255, 255, 255, 0.15),
    1px 0 0 rgba(255, 255, 255, 0.2),
    -1px 0 0 rgba(255, 255, 255, 0.2),
    0 1px 0 rgba(255, 255, 255, 0.2),
    0 -1px 0 rgba(255, 255, 255, 0.2);
}
.oshi-card-custom-html * {
  color: var(--ink) !important;
  text-align: center;
}
.oshi-card-custom-html a {
  color: var(--accent) !important;
  text-decoration: underline;
  text-decoration-style: dotted;
  text-underline-offset: 3px;
}
.oshi-card-custom-html a:hover {
  color: var(--accent-2) !important;
  text-shadow: 0 0 8px rgba(255, 255, 255, 0.35);
}


/* ===== Footer ===== */

.oshi-card-footer {
  color: var(--ink-muted) !important;
  font-size: 0.75em;
  letter-spacing: 0.5px;
  opacity: 0.5;
  text-align: center;
  padding: 8px 12px;
  border-top: 1px dotted rgba(255, 255, 255, 0.12);
}
.oshi-card-footer a {
  color: var(--ink-muted) !important;
  text-decoration: underline;
  text-decoration-style: dotted;
  text-underline-offset: 2px;
}
.oshi-card-footer a:hover {
  color: var(--accent) !important;
}
.oshi-card-footer .sparkle {
  opacity: 0.4;
}


/* ===== Witness Overrides (Boop ‚Üí Observe) ===== */

.boop-link {
  font-size: 0 !important;
  color: transparent !important;
  text-decoration: none !important;
}
.boop-link > * {
  display: none !important;
}
.boop-link::before {
  content: "üëÅÔ∏è Observe";
  display: inline-block;
  font-size: 0.9rem;
  letter-spacing: 0.5px;
  line-height: 1;
  color: var(--ink);
}


/* ===== Keyframes ===== */

@keyframes vt-drift {
  0%   { transform: translateY(0); opacity: 0.75; }
  50%  { transform: translateY(6px); opacity: 0.6; }
  100% { transform: translateY(0); opacity: 0.75; }
}

@keyframes vt-name-flicker {
  0%   { opacity: 1; text-shadow: 0 0 3px rgba(255, 255, 255, 0.2); }
  91%  { opacity: 1; }
  92%  { opacity: 0.7; }
  93%  { opacity: 1; }
  95%  { opacity: 0.8; }
  96%  { opacity: 1; }
  100% { opacity: 1; text-shadow: 0 0 3px rgba(255, 255, 255, 0.2); }
}

@keyframes vt-name-mask {
  0%   { -webkit-mask-position: 0 0; mask-position: 0 0; }
  100% { -webkit-mask-position: 1ch 0; mask-position: 1ch 0; }
}

@keyframes blurb-ticker-left {
  from { transform: translateX(0); }
  to   { transform: translateX(-50%); }
}

@keyframes blurb-ticker-right {
  from { transform: translateX(-50%); }
  to   { transform: translateX(0); }
}

@keyframes blurb-drift-a {
  0%   { transform: translateX(-80px); }
  18%  { transform: translateX(-20px); }
  32%  { transform: translateX(-35px); }
  55%  { transform: translateX(15px); }
  72%  { transform: translateX(50px); }
  86%  { transform: translateX(30px); }
  100% { transform: translateX(80px); }
}

@keyframes blurb-drift-b {
  0%   { transform: translateX(-45px); }
  22%  { transform: translateX(-5px); }
  38%  { transform: translateX(-22px); }
  58%  { transform: translateX(14px); }
  78%  { transform: translateX(35px); }
  100% { transform: translateX(45px); }
}

@keyframes blurb-drift-c {
  0%   { transform: translateX(-65px); }
  28%  { transform: translateX(-40px); }
  48%  { transform: translateX(6px); }
  65%  { transform: translateX(-8px); }
  82%  { transform: translateX(40px); }
  100% { transform: translateX(65px); }
}
